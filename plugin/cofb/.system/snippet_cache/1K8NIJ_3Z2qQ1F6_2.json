{"self":{"style":{"backgroundColor":"black","color":"white","visibility":"hidden"},"props":{"type":"Box"}},"html":"<div lx class=\"lx-abspos lxps-grid-v\" style=\"right:0%;left:0%;bottom:0%;top:0%;grid-template-rows:1fr 4fr 1fr;\"><div lx style=\"position:relative;min-height:40px;display:flex;flex-direction:row;text-align:center;align-items:center;justify-content:center;\"><div lx class=\"lx-TextBox\" style=\"width:auto;height:auto;\">\u0418\u0433\u0440\u043e\u043a\u0438<\/div><\/div><div lx class=\"lxps-grid-v\" style=\"position:relative;min-height:40px;grid-template-columns:repeat(12,1fr);padding-top:1px;padding-bottom:1px;padding-left:10px;padding-right:10px;grid-row-gap:10px;grid-column-gap:10px;\"><\/div><div lx class=\"lxps-grid-v\" style=\"position:relative;min-height:40px;grid-template-columns:repeat(2,1fr);padding-top:10px;padding-bottom:10px;padding-left:10px;padding-right:10px;grid-row-gap:10px;grid-column-gap:10px;grid-template-rows:repeat(1,1fr);\"><div lx class=\"lx-Button\" style=\"position:relative;min-height:40px;min-width:40px;grid-area:1\/1\/2\/2;\"><div lx class=\"lx-TextBox\" style=\"width:auto;height:auto;\">\u0414\u0430\u043b\u0435\u0435<\/div><\/div><div lx class=\"lx-Button\" style=\"position:relative;min-height:40px;min-width:40px;grid-area:1\/2\/2\/3;\"><div lx class=\"lx-TextBox\" style=\"width:auto;height:auto;\">\u0417\u0430\u043a\u0440\u044b\u0442\u044c<\/div><\/div><\/div><\/div><div lx class=\"lx-abspos lxps-grid-v\" style=\"right:0%;left:0%;bottom:0%;top:0%;grid-template-rows:1fr 4fr 1fr;\"><div lx style=\"position:relative;min-height:40px;\"><div lx class=\"lx-abspos lxps-grid-v\" style=\"right:0%;left:0%;bottom:0%;top:0%;grid-template-columns:repeat(12,1fr);padding-top:10px;padding-bottom:10px;padding-left:10px;padding-right:10px;grid-row-gap:10px;grid-column-gap:10px;grid-template-rows:repeat(1,1fr);\"><div lx style=\"position:relative;min-height:40px;min-width:40px;grid-area:1\/1\/2\/11;display:flex;flex-direction:row;text-align:center;align-items:center;justify-content:center;\"><div lx class=\"lx-TextBox\" style=\"width:auto;height:auto;\">\u041f\u043e\u0440\u044f\u0434\u043e\u043a \u0445\u043e\u0434\u0430<\/div><\/div><div lx style=\"position:relative;min-height:40px;min-width:40px;grid-area:1\/11\/2\/12;overflow:visible;\"><div title=\"\u041d\u0430\u0436\u043c\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u044c \u0445\u043e\u0434\u0430\" lx class=\"lx-abspos\" style=\"width:100%;left:0%;height:100%;top:0%;background-image:url(\/web\/images\/games_cofb\/cube.png);background-repeat:no-repeat;background-size:100% 100%;cursor:pointer;\"><\/div><\/div><div title=\"\u0417\u0430 \u0438\u0433\u0440\u043e\u043a\u0430 \u0431\u0443\u0434\u0435\u0442 \u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\" lx style=\"position:relative;min-height:40px;min-width:40px;grid-area:1\/12\/2\/13;background-image:url(\/web\/images\/games_cofb\/comp.png);background-repeat:no-repeat;background-size:100% 100%;\"><\/div><\/div><\/div><div lx class=\"lxps-grid-v\" style=\"position:relative;min-height:40px;padding-top:1px;padding-bottom:1px;padding-left:10px;padding-right:10px;grid-row-gap:10px;\"><\/div><div lx class=\"lxps-grid-v\" style=\"position:relative;min-height:40px;grid-template-columns:repeat(3,1fr);padding-top:10px;padding-bottom:10px;padding-left:10px;padding-right:10px;grid-row-gap:10px;grid-column-gap:10px;grid-template-rows:repeat(1,1fr);\"><div lx class=\"lx-Button\" style=\"position:relative;min-height:40px;min-width:40px;grid-area:1\/1\/2\/2;\"><div lx class=\"lx-TextBox\" style=\"width:auto;height:auto;\">\u0414\u0430\u043b\u0435\u0435<\/div><\/div><div lx class=\"lx-Button\" style=\"position:relative;min-height:40px;min-width:40px;grid-area:1\/2\/2\/3;\"><div lx class=\"lx-TextBox\" style=\"width:auto;height:auto;\">\u041d\u0430\u0437\u0430\u0434<\/div><\/div><div lx class=\"lx-Button\" style=\"position:relative;min-height:40px;min-width:40px;grid-area:1\/3\/2\/4;\"><div lx class=\"lx-TextBox\" style=\"width:auto;height:auto;\">\u0417\u0430\u043a\u0440\u044b\u0442\u044c<\/div><\/div><\/div><\/div>","lx":[{"key":"firstStep","geom":"1,3|5,7","type":"Box","renderIndex":0,"__ps":"lx.StreamPositioningStrategy;ds:1;if:3;t:2;d:1"},{"streamSize":"1fr","type":"Box","renderIndex":1,"__ps":"lx.AlignPositioningStrategy;ds:1;if:3;d:2;h:2;v:6"},{"key":"text","geom":"2,1|6,5","type":"TextBox","renderIndex":2},{"key":"gamersList","streamSize":"4fr","type":"Box","renderIndex":3,"__ps":"lx.GridPositioningStrategy;ds:1;if:3;i:10px,10px,10px,10px,1px,1px;c:12;t:2;m:"},{"streamSize":"1fr","type":"Box","renderIndex":4,"__ps":"lx.GridPositioningStrategy;ds:1;if:3;i:10px,10px,10px,10px,10px,10px;c:2;t:2;m:11"},{"key":"butOk","type":"Button","renderIndex":5},{"key":"text","geom":"2,1|6,5","type":"TextBox","renderIndex":6},{"key":"butClose","type":"Button","renderIndex":7},{"key":"text","geom":"2,1|6,5","type":"TextBox","renderIndex":8},{"key":"secondStep","geom":"1,3|5,7","type":"Box","renderIndex":9,"__ps":"lx.StreamPositioningStrategy;ds:1;if:3;t:2;d:1"},{"streamSize":"1fr","type":"Box","renderIndex":10},{"geom":"1,3|5,7","type":"Box","renderIndex":11,"__ps":"lx.GridPositioningStrategy;ds:1;if:3;i:10px,10px,10px,10px,10px,10px;c:12;t:2;m:111111111111"},{"type":"Box","renderIndex":12,"__ps":"lx.AlignPositioningStrategy;ds:1;if:3;d:2;h:2;v:6"},{"key":"text","geom":"2,1|6,5","type":"TextBox","renderIndex":13},{"type":"Box","renderIndex":14},{"key":"cube","geom":"1,2|5,6","type":"Box","renderIndex":15},{"type":"Box","renderIndex":16},{"key":"gamersList","streamSize":"4fr","type":"Box","renderIndex":17,"__ps":"lx.StreamPositioningStrategy;ds:1;if:3;i:10px,10px,10px,10px,1px,1px;t:2;d:1"},{"streamSize":"1fr","type":"Box","renderIndex":18,"__ps":"lx.GridPositioningStrategy;ds:1;if:3;i:10px,10px,10px,10px,10px,10px;c:3;t:2;m:111"},{"key":"butOk","type":"Button","renderIndex":19},{"key":"text","geom":"2,1|6,5","type":"TextBox","renderIndex":20},{"key":"butBack","type":"Button","renderIndex":21},{"key":"text","geom":"2,1|6,5","type":"TextBox","renderIndex":22},{"key":"butClose","type":"Button","renderIndex":23},{"key":"text","geom":"2,1|6,5","type":"TextBox","renderIndex":24}],"js":"var snippetBox = Snippet.widget;\nvar firstStep = snippetBox.childrenByKeys.firstStep;\nvar secondStep = snippetBox.childrenByKeys.secondStep;\n\nSnippet.gamersData = [];\n\nsnippetBox.open = function() {\n\tif (this.visibility()) return;\n\tthis.childrenByKeys.secondStep.hide();\n\tthis.childrenByKeys.firstStep.show();\n\tthis.show();\n\tthis.find('check').each((ch)=>ch.value(false));\n};\n\nsnippetBox.close = function() {\n\tif (!this.visibility()) return;\n\tthis.hide();\n};\n\n\nvar gamersList = firstStep.childrenByKeys.gamersList;\ngamersList.begin();\nfor (var i=0; i<4; i++) {\n\tvar color = new lx.Box({width: 2});\n\tcolor.picture(cofb.GAMER_COLOR[i] + '.jpg');\n\tcolor.border({color:'gray'});\n\n\tvar name = new lx.Box({width: 8});\n\tname.text(cofb.GAMER_NAMES[i]);\n\tname.align(lx.CENTER, lx.MIDDLE);\n\n\tvar ch = new lx.Box({width: 2});\n\tvar check = ch.add(lx.Checkbox, {key: 'check'});\n\tch.align(lx.CENTER, lx.MIDDLE);\n\tcheck.num = i;\n}\ngamersList.end();\n\nfirstStep.find('butOk').click(function() {\n\tSnippet.gamersData = [];\n\tvar checks = firstStep.find('check');\n\n\tchecks.each((a)=>{\n\t\tif (a.value()) Snippet.gamersData.push({num:a.num, seq:null, ai:false});\n\t});\n\n\tif (Snippet.gamersData.length < 2) {\n\t\tlx.Tost.warning('\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043c\u0438\u043d\u0438\u043c\u0443\u043c \u0434\u0432\u0443\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432');\n\t\treturn;\n\t}\n\n\t__startSequanceMenu();\n});\nfirstStep.find('butClose').click(()=>snippetBox.hide());\n\n\nvar sequensRecipient = null;\n\nsecondStep.find('butBack').click(()=>__back());\nsecondStep.find('butClose').click(()=>snippetBox.hide());\nsecondStep.find('cube').click(()=>__genSequens());\n\nsecondStep.find('butOk').click(()=>{\n\tvar seqReady = true;\n\tSnippet.gamersData.each((a)=>{\n\t\tif (a.seq === null) seqReady = false;\n\t});\n\tif (!seqReady) {\n\t\tlx.Tost.warning('\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u043d\u0443\u0436\u043d\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u0445\u043e\u0434\u043e\u0432. \u041a\u043b\u0438\u043a\u043d\u0438\u0442\u0435 \u043f\u043e \u043a\u0443\u0431\u0438\u043a\u0443');\n\t\treturn;\n\t}\n\n\tvar data = Snippet.gamersData;\n\tSnippet.gamersData = [];\n\tsnippetBox.hide();\n\n\t\tbgGame.start(data);\n});\n\n\nfunction __back() {\n\tsecondStep.hide();\n\tfirstStep.show();\n}\n\nfunction __startSequanceMenu() {\n\tfirstStep.hide();\n\tsecondStep.show();\n\tsecondStep.childrenByKeys.gamersList.clear();\n\tsecondStep.find('cube').addClass('pulse');\n\n\tSnippet.sequence = new Array(Snippet.gamersData.length);\n\n\tSnippet.AIlist = [false, false, false, false];\n\tfor (var i=0; i<Snippet.gamersData.length; i++) {\n\t\tvar num = Snippet.gamersData[i].num;\n\t\tvar row = secondStep.childrenByKeys.gamersList.add(lx.Box);\n\n\t\trow.gridProportional({step:'10px'});\n\t\trow.begin();\n\t\t\tvar color = new lx.Box({width: 2});\n\t\t\tcolor.picture(cofb.GAMER_COLOR[num] + '.jpg');\n\t\t\tcolor.border({color:'gray'});\n\n\t\t\tvar name = new lx.Box({width: 8, text:cofb.GAMER_NAMES[num]});\n\t\t\tname.align(lx.CENTER, lx.MIDDLE);\n\n\t\t\tvar seq = new lx.Box({key:'seq', width:1, text:'?'});\n\t\t\tseq.align(lx.CENTER, lx.MIDDLE);\n\t\t\tseq.setAttribute('title', '\u041e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u044c \u0445\u043e\u0434\u0430');\n\n\t\t\tvar ch = new lx.Box({width: 1});\n\t\t\tch.setAttribute('title', '\u0417\u0430 \u0438\u0433\u0440\u043e\u043a\u0430 \u0431\u0443\u0434\u0435\u0442 \u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440');\n\t\t\tvar check = ch.add(lx.Checkbox, {key: 'check'});\n\t\t\tch.align(lx.CENTER, lx.MIDDLE);\n\t\t\tcheck.gamerDataIndex = i;\n\t\t\tcheck.on('change', function(){Snippet.gamersData[this.gamerDataIndex].ai = this.value();});\n\t\trow.end();\n\t}\n\n\tgamerIndexForGenSequens = 0;\n\t__setSequensRecipient(0);\n}\n\nfunction __genSequens() {\n\tvar seq = __genSequensProcess();\n\tsecondStep.childrenByKeys.gamersList.child(sequensRecipient).childrenByKeys.seq.text(seq);\n\tSnippet.gamersData[sequensRecipient].seq = seq;\n\n\tif (sequensRecipient == Snippet.gamersData.length - 1) {\n\t\t__setSequensRecipient(null);\n\t\tsecondStep.find('cube').removeClass('pulse');\n\t} else __setSequensRecipient(sequensRecipient + 1);\n}\n\nfunction __genSequensProcess() {\n\tvar rand = lx.Math.randomInteger(1, 6);\t\n\n\t\tfunction checkSame(val) {\n\t\tfor (var i=0; i<Snippet.gamersData.length; i++)\n\t\t\tif (Snippet.gamersData[i].seq === val)\n\t\t\t\treturn true;\n\t\treturn false;\n\t}\n\tif (checkSame(rand)) {\n\t\t\t\tvar direction = lx.Math.randomInteger(1, 2) == 1 ? -1 : 1;\n\t\twhile (checkSame(rand)) {\n\t\t\trand += direction;\n\t\t\tif (rand == 7) rand = 1;\n\t\t\telse if (rand == 0) rand = 6;\n\t\t}\n\t}\n\n\treturn rand;\n}\n\nfunction __setSequensRecipient(value) {\n\tif (sequensRecipient !== null)\n\t\tsecondStep.childrenByKeys.gamersList.child(sequensRecipient).fill('');\n\tsequensRecipient = value;\n\tif (sequensRecipient !== null)\n\t\tsecondStep.childrenByKeys.gamersList.child(sequensRecipient).fill('#888888');\n}"}