{"self":{"style":{"visibility":"hidden"},"props":{"type":"Box"}},"html":"<div lx class=\"lx-abspos\" style=\"right:0%;left:0%;bottom:0%;top:0%;background-color:black;opacity:0.5;\"><\/div><div lx class=\"lx-abspos lxps-grid-v\" style=\"right:0%;left:0%;bottom:0%;top:0%;padding-top:10px;padding-bottom:10px;padding-left:10px;padding-right:10px;grid-row-gap:10px;grid-template-rows:1fr 12fr;\"><div lx style=\"position:relative;min-height:40px;color:white;\"><div lx class=\"lx-abspos\" style=\"right:0%;left:0%;bottom:0%;top:0%;background-color:black;opacity:0.5;\"><\/div><div lx class=\"lx-abspos\" style=\"right:0%;left:0%;bottom:0%;top:0%;display:flex;flex-direction:row;text-align:center;align-items:center;justify-content:center;\"><div lx class=\"lx-TextBox\" style=\"width:auto;height:auto;\">\u041d\u0430\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u043e\u0447\u043a\u0438<\/div><\/div><div lx class=\"lx-abspos\" style=\"right:10px;left:10px;bottom:10px;top:10px;\"><img onLoad=\"this.setAttribute('loaded', 1)\" loaded=\"0\" src=\"\/web\/images\/games_cofb\/close.png\" lx class=\"lx-abspos\" style=\"width:0%;right:0%;height:0%;top:0%;cursor:pointer;\"><\/img><\/div><\/div><div lx class=\"lxps-grid-v\" style=\"position:relative;min-height:40px;grid-template-columns:repeat(2,1fr);grid-row-gap:10px;grid-column-gap:10px;\"><\/div><\/div>","lx":[{"geom":"1,3|5,7","type":"Rect","renderIndex":0},{"geom":"1,3|5,7","type":"Box","renderIndex":1,"__ps":"lx.StreamPositioningStrategy;ds:1;if:3;i:10px,10px,10px,10px,10px,10px;t:2;d:1"},{"streamSize":"1fr","type":"Box","renderIndex":2},{"geom":"1,3|5,7","type":"Rect","renderIndex":3},{"geom":"1,3|5,7","type":"Box","renderIndex":4,"__ps":"lx.AlignPositioningStrategy;ds:1;if:3;d:2;h:2;v:6"},{"key":"text","geom":"2,1|6,5","type":"TextBox","forOnload":[[".displayOnce",".adapt"]],"renderIndex":5},{"geom":"1,3|5,7","type":"Box","renderIndex":6},{"key":"closeBut","geom":"2,3|5,6","type":"Image","forOnload":[".adapt"],"renderIndex":7},{"key":"body","streamSize":"12fr","type":"Box","renderIndex":8,"__ps":"lx.GridPositioningStrategy;ds:1;if:3;i:10px,10px,0,0,0,0;c:2;t:2;m:"}],"js":"cofb.EventSupervisor.subscribe('cofb_game_over', function(gamer) {\n\tPlugin.get('confirmPopup').open('\u0418\u0433\u0440\u0430 \u043e\u043a\u043e\u043d\u0447\u0435\u043d\u0430. \u0425\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u043e\u0447\u043a\u043e\u0432?', ()=>{\n\t\tPlugin.get('scoreTable').open();\n\t});\n});\n\nconst snippetBox = Snippet.widget;\nconst bodyBox = Snippet.find('body');\n\nPlugin.get('butOpenScore').click(()=>snippetBox.open());\nSnippet.find('closeBut').click(()=>snippetBox.close());\n\nsnippetBox.open = function() {\n\tbodyBox.clear();\n\tfor (var i in bgGame.gamers)\n\t\t__addGamerInfoBox(bgGame.gamers[i]);\n\n\tthis.show();\n};\n\nsnippetBox.close = function() {\n\tthis.hide();\n\tbodyBox.clear();\n};\n\nfunction __addGamerInfoBox(gamer) {\n\tvar box = new lx.Box({parent: bodyBox});\n\tbox.useRenderCache();\n\tnew lx.Rect({parent:box, geom:true, style:{fill:'black', opacity:0.5}});\n\n\tvar mainBox = new lx.Box({parent:box, geom:true});\n\tmainBox.streamProportional({indent:'10px'});\n\n\tvar headerWrapper = new lx.Box({parent:mainBox, height:'50px'});\n\tnew lx.Rect({parent:headerWrapper, geom:true, style:{fill:'black', opacity:0.5}});\n\tvar header = new lx.Box({parent:headerWrapper, geom:true});\n\tnew lx.Box({parent:header, size:['30px', '30px'], picture:cofb.GAMER_COLOR[gamer.id] + '.jpg'});\n\n\tvar body = new lx.Box({parent:mainBox});\n\tbody.overflow('auto');\n\tvar grid = new lx.Box({parent:body, geom:[0, 0, '100%', 'auto']});\n\tgrid.grid({step:'10px', minHeight:'50px'});\n\n\tvar points = 0;\n\tfor (var i=0; i<gamer.pointsInfo.length; i++) {\n\t\tvar info = gamer.pointsInfo[i],\n\t\t\ttext,\n\t\t\tamt = info.amt;\n\n\t\tswitch (info.cod) {\n\t\t\tcase SCORE_ANIMAL : {\n\t\t\t\tvar arr = info.info.split('.'),\n\t\t\t\t\tname = ['\u043a\u043e\u0440\u043e\u0432\u044b', '\u043a\u0443\u0440\u044b', '\u043e\u0432\u0446\u044b', '\u0441\u0432\u0438\u043d\u044c\u0438'];\n\t\t\t\ttext = '\u0420\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u044b \u0436\u0438\u0432\u043e\u0442\u043d\u044b\u0435: ' + name[arr[0]] + ', ' + arr[1] + ' \u0448\u0442';\n\t\t\t} break;\n\t\t\tcase SCORE_GOODS : text = '\u041f\u0440\u043e\u0434\u0430\u043d\u044b \u0442\u043e\u0432\u0430\u0440\u044b: ' + info.info + ' \u0448\u0442'; break;\n\t\t\tcase SCORE_TOWER : text = '\u0420\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u0436\u0435\u0432\u0430\u044f \u0431\u0430\u0448\u043d\u044f'; break;\n\t\t\tcase SCORE_FILL : text = '\u0417\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0430 \u043e\u0431\u043b\u0430\u0441\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c ' + info.info + ' \u044f\u0447\u0435\u0435\u043a'; break;\n\t\t\tcase SCORE_FILLBONUS : text = '\u0411\u043e\u043d\u0443\u0441 \u0444\u0430\u0437\u044b \u0438\u0433\u0440\u044b (' + info.info + ') \u0437\u0430 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043e\u0431\u043b\u0430\u0441\u0442\u0438'; break;\n\t\t\tcase SCORE_WORKER : text = '\u041e\u0441\u0442\u0430\u043b\u043e\u0441\u044c \u0440\u0430\u0431\u043e\u0447\u0438\u0445: ' + info.info; break;\n\t\t\tcase SCORE_SILVER : text = '\u0417\u0430\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u043e\u0435 \u0441\u0435\u0440\u0435\u0431\u0440\u043e'; break;\n\t\t\tcase SCORE_LOSTGOODS : text = '\u041d\u0435 \u043f\u0440\u043e\u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u044b'; break;\n\t\t\tcase SCORE_BONUS : {\n\t\t\t\ttext = '\u0411\u043e\u043d\u0443\u0441 \u0437\u0430 \u043f\u043e\u043b\u043d\u043e\u0435 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043e\u0434\u043d\u043e\u0433\u043e \u0446\u0432\u0435\u0442\u0430';\n\t\t\t} break;\n\t\t\tcase SCORE_KNOWELEGE : {\n\t\t\t\tswitch (info.info) {\n\t\t\t\t\tcase VARIANT_KNOWLEDGE_15 : text = '\u0417\u043d\u0430\u043d\u0438\u0435: 3 \u043e\u0447\u043a\u0430 \u0437\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u0442\u0438\u043f \u043f\u0440\u043e\u0434\u0430\u043d\u043d\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432'; break;\n\t\t\t\t\tcase VARIANT_KNOWLEDGE_16 : text = '\u0417\u043d\u0430\u043d\u0438\u0435: 4 \u043e\u0447\u043a\u0430 \u0437\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u0441\u043a\u043b\u0430\u0434'; break;\n\t\t\t\t\tcase VARIANT_KNOWLEDGE_17 : text = '\u0417\u043d\u0430\u043d\u0438\u0435: 4 \u043e\u0447\u043a\u0430 \u0437\u0430 \u043a\u0430\u0436\u0434\u0443\u044e \u0441\u0442\u043e\u0440\u043e\u0436\u0435\u0432\u0443\u044e \u0431\u0430\u0448\u043d\u044e'; break;\n\t\t\t\t\tcase VARIANT_KNOWLEDGE_18 : text = '\u0417\u043d\u0430\u043d\u0438\u0435: 4 \u043e\u0447\u043a\u0430 \u0437\u0430 \u043a\u0430\u0436\u0434\u0443\u044e \u043b\u0435\u0441\u043e\u043f\u0438\u043b\u043a\u0443'; break;\n\t\t\t\t\tcase VARIANT_KNOWLEDGE_19 : text = '\u0417\u043d\u0430\u043d\u0438\u0435: 4 \u043e\u0447\u043a\u0430 \u0437\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u0445\u0440\u0430\u043c'; break;\n\t\t\t\t\tcase VARIANT_KNOWLEDGE_20 : text = '\u0417\u043d\u0430\u043d\u0438\u0435: 4 \u043e\u0447\u043a\u0430 \u0437\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u0440\u044b\u043d\u043e\u043a'; break;\n\t\t\t\t\tcase VARIANT_KNOWLEDGE_21 : text = '\u0417\u043d\u0430\u043d\u0438\u0435: 4 \u043e\u0447\u043a\u0430 \u0437\u0430 \u043a\u0430\u0436\u0434\u0443\u044e \u0433\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u0443'; break;\n\t\t\t\t\tcase VARIANT_KNOWLEDGE_22 : text = '\u0417\u043d\u0430\u043d\u0438\u0435: 4 \u043e\u0447\u043a\u0430 \u0437\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u0431\u0430\u043d\u043a'; break;\n\t\t\t\t\tcase VARIANT_KNOWLEDGE_23 : text = '\u0417\u043d\u0430\u043d\u0438\u0435: 4 \u043e\u0447\u043a\u0430 \u0437\u0430 \u043a\u0430\u0436\u0434\u0443\u044e \u0440\u0430\u0442\u0443\u0448\u0443'; break;\n\t\t\t\t\tcase VARIANT_KNOWLEDGE_24 : text = '\u0417\u043d\u0430\u043d\u0438\u0435: 4 \u043e\u0447\u043a\u0430 \u0437\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u0442\u0438\u043f \u0436\u0438\u0432\u043e\u0442\u043d\u044b\u0445'; break;\n\t\t\t\t\tcase VARIANT_KNOWLEDGE_25 : text = '\u0417\u043d\u0430\u043d\u0438\u0435: 1 \u043e\u0447\u043a\u043e \u0437\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u043f\u0440\u043e\u0434\u0430\u043d\u043d\u044b\u0439 \u0442\u043e\u0432\u0430\u0440'; break;\n\t\t\t\t\tcase VARIANT_KNOWLEDGE_26 : text = '\u0417\u043d\u0430\u043d\u0438\u0435: 2 \u043e\u0447\u043a\u0430 \u0437\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u0436\u0435\u0442\u043e\u043d \u0431\u043e\u043d\u0443\u0441\u0430'; break;\n\t\t\t\t}\n\t\t\t} break;\n\t\t}\n\n\t\tpoints += amt;\n\t\t__addBox(grid, text, 10, lx.LEFT);\n\t\t__addBox(grid, amt, 2, lx.CENTER);\n\t}\n\n\theader.style('color', 'white');\n\theader.text(gamer.getName() + ': ' + points);\n\theader.align({\n\t\thorizontal: lx.LEFT,\n\t\tvertical: lx.MIDDLE,\n\t\tindent: '10px'\n\t});\n\n\tbox.applyRenderCache();\n}\n\nfunction __addBox(parent, text, width, hor) {\n\tvar box = new lx.Box({parent, width});\n\tnew lx.Rect({parent:box, geom:true, style:{fill:'black', opacity:0.5}});\n\tbox.style('color', 'white');\n\tvar txt = new lx.Box({parent:box, geom:true});\n\ttxt.text(text);\n\ttxt.align(hor, lx.MIDDLE);\n}"}